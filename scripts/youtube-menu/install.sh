#!/bin/sh
# –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –º–µ–Ω—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–π YouTube –¥–ª—è Zapret-Manager
# –° —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

echo "========================================="
echo "  üéØ –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –º–µ–Ω—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–π YouTube"
echo "  –° —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–≤—Ç–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
echo "========================================="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ root
if [ "$(id -u)" -ne 0 ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –æ—Ç root"
    echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: sudo $0"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Zapret
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É Zapret..."
if [ ! -f "/opt/zapret/nfq/nfqws" ]; then
    echo "‚ùå –û–®–ò–ë–ö–ê: Zapret-Manager –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Zapret-Manager:"
    echo "https://github.com/StressOzz/Zapret-Manager"
    exit 1
fi
echo "‚úÖ Zapret-Manager –Ω–∞–π–¥–µ–Ω"

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
echo "üìÅ –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏..."
mkdir -p /opt/zapret/strategies /opt/zapret/backups /usr/local/bin
echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã"

# –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –º–µ–Ω—é
echo "‚¨áÔ∏è  –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç –º–µ–Ω—é..."
URL_MENU="https://raw.githubusercontent.com/mataf0n/Zapret-Manager/main/scripts/youtube-menu/zapret-menu.sh"

if wget -q "$URL_MENU" -O /usr/local/bin/zapret-menu.sh; then
    chmod +x /usr/local/bin/zapret-menu.sh
    echo "‚úÖ –°–∫—Ä–∏–ø—Ç –º–µ–Ω—é –∑–∞–≥—Ä—É–∂–µ–Ω"
else
    echo "‚ùå –û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –º–µ–Ω—é"
    echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É"
    exit 1
fi

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–º–ª–∏–Ω–∫–æ–≤ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
echo "üîó –°–æ–∑–¥–∞–µ–º –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞..."
ln -sf /usr/local/bin/zapret-menu.sh /usr/bin/zapret-menu 2>/dev/null || true
ln -sf /usr/local/bin/zapret-menu.sh /usr/bin/zapret-manager 2>/dev/null || true
ln -sf /usr/local/bin/zapret-menu.sh /usr/bin/youtube-tester 2>/dev/null || true
echo "‚úÖ –ö–æ–º–∞–Ω–¥—ã —Å–æ–∑–¥–∞–Ω—ã"

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
echo "üìÑ –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π..."
if /usr/local/bin/zapret-menu.sh --create > /tmp/zapret-install.log 2>&1; then
    echo "‚úÖ –§–∞–π–ª—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å–æ–∑–¥–∞–Ω—ã"
else
    echo "‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∞–π–ª—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –º–æ–≥–ª–∏ –Ω–µ —Å–æ–∑–¥–∞—Ç—å—Å—Ç—å"
    echo "–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∏—Ö –ø–æ–∑–∂–µ –∫–æ–º–∞–Ω–¥–æ–π: zapret-menu --create"
fi

echo ""
echo "========================================="
echo "  üéâ –£–°–¢–ê–ù–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!"
echo "========================================="
echo ""
echo "üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:"
echo "  zapret-menu          - –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–µ–Ω—é"
echo "  youtube-tester       - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞"
echo ""
echo "üì± –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:"
echo "  ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 16 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π YouTube"
echo "  ‚Ä¢ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —ç–º–æ–¥–∑–∏"
echo "  ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤"
echo "  ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º"
echo "  ‚Ä¢ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã"
echo ""
echo "üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:"
echo "  1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: zapret-menu"
echo "  2. –ù–∞–∂–º–∏—Ç–µ 'A' –¥–ª—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
echo "  3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ"
echo "  4. –ü–æ—Å–ª–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä"
echo ""
echo "üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:"
echo "  https://github.com/mataf0n/Zapret-Manager"
echo ""
echo "‚ùì –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞:"
echo "  –°–æ–∑–¥–∞–π—Ç–µ Issue –Ω–∞ GitHub –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã"
echo "========================================="

# –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
echo ""
echo "üí° –°–æ–≤–µ—Ç—ã –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:"
echo "  1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Zapret —Ä–∞–±–æ—Ç–∞–µ—Ç: /etc/init.d/zapret status"
echo "  2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç: zapret-menu --auto"
echo "  3. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏"
echo "  4. –ü—Ä–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç–∞—é—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ—ë"
echo ""
